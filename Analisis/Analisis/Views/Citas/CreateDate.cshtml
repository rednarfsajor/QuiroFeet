@model Analisis.BD.Citas
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Agendar Cita";
}

<div class="qf-shell">
    <div class="qf-card">
        <!-- Header -->
        <div class="qf-header">
            <div>
                <h1 class="qf-title"><i class="bi bi-calendar-plus me-2"></i>Agendar Cita</h1>
                <p class="qf-subtitle">Por favor, completa el formulario para agendar una nueva cita el día @ViewBag.Fecha</p>
            </div>
        </div>

        @using (Html.BeginForm("CreateDate", "Citas", FormMethod.Post, new { @class = "formulario" }))
        {
            @Html.AntiForgeryToken()

            <div class="form-grid">
                <!-- Fecha (solo lectura) -->
                <div class="form-group">
                    @Html.LabelFor(model => model.fecha)
                    <div class="input-icon">
                        <i class="bi bi-calendar-event"></i>
                        <input type="text" name="fecha" class="form-control" value="@Model.fecha.ToString("dd/MM/yyyy")" readonly />
                    </div>
                    @Html.ValidationMessageFor(model => model.fecha, "", new { @class = "field-error" })
                </div>

                <!-- Hora -->
                <div class="form-group">
                    @Html.LabelFor(model => model.hora)
                    <div class="input-icon">
                        <i class="bi bi-clock"></i>
                        @Html.TextBoxFor(model => model.hora, new
                        {
                            @class = "form-control",
                            @type = "time",
                            @min = "07:00",
                            @max = "19:00",
                            @step = "900",
                            @required = "required"
                        })
                    </div>
                    @Html.ValidationMessageFor(model => model.hora, "", new { @class = "field-error" })
                </div>

                <!-- Servicio -->
                <div class="form-group">
                    @Html.LabelFor(model => model.id_servicio, "Servicio")
                    <div class="input-icon">
                        <i class="bi bi-truck"></i>
                        @Html.DropDownListFor(model => model.id_servicio, ViewBag.Servicios as SelectList, "-- Seleccione un servicio --", new { @class = "form-control", required = "required" })
                    </div>
                    @Html.ValidationMessageFor(model => model.id_servicio, "", new { @class = "field-error" })
                </div>

                <!-- Cliente -->
                <div class="form-group">
                    @Html.LabelFor(model => model.id_cliente, "Cliente")
                    <div class="input-icon">
                        <i class="bi bi-truck"></i>
                        @Html.DropDownListFor(model => model.id_cliente, ViewBag.Clientes as SelectList, "-- Seleccione un cliente --", new { @class = "form-control", required = "required" })
                    </div>
                    @Html.ValidationMessageFor(model => model.id_cliente, "", new { @class = "field-error" })
                </div>

                <!-- Profesional -->
                <div class="form-group">
                    @Html.LabelFor(model => model.id_profesional, "Profesional")
                    <div class="input-icon">
                        <i class="bi bi-truck"></i>
                        @Html.DropDownListFor(model => model.id_profesional, ViewBag.Profesionales as SelectList, "-- Seleccione un profesional --", new { @class = "form-control", required = "required" })
                    </div>
                    @Html.ValidationMessageFor(model => model.id_profesional, "", new { @class = "field-error" })
                </div>
            </div>

            <!-- Botones (mismos textos) -->
            <div class="form-buttons">
                <button type="submit" class="btn-submit">
                    <i class="bi bi-check-circle-fill me-1"></i> Registrar Cita
                </button>
                <a href="@Url.Action("Calendar", "Citas")" class="btn-cancel">
                    <i class="bi bi-x-circle-fill me-1"></i> Cancelar
                </a>
            </div>
        }
    </div>
</div>

<!-- Notificación Estilizada (se mantiene) -->
<div id="notification" class="notification" style="display:none;">
    Cita Agendada Correctamente
</div>

<script>
    function handleSubmit(event) {
        event.preventDefault();
        const notification = document.getElementById('notification');
        notification.style.display = 'block';
        setTimeout(() => {
            notification.style.display = 'none';
            window.location.href = '/Citas/Calendar';
        }, 3000);
        return false;
    }

    // foco visual en inputs con icono
    document.querySelectorAll('.input-icon .form-control').forEach(i => {
        i.addEventListener('focus', e => e.target.parentElement.classList.add('focus'));
        i.addEventListener('blur', e => e.target.parentElement.classList.remove('focus'));
    });
</script>

<style>
    :root {
        --qf-bg: #f6f8f9;
        --qf-card: #ffffff;
        --qf-text: #1f2d2f;
        --qf-muted: #6b7a7d;
        --qf-primary: #14532D;
        --qf-primary-100: #E5F1EA;
        --qf-border: #e6ecef;
        --qf-shadow: 0 8px 24px rgba(27,37,44,.08);
    }

    /* Shell + Card */
    .qf-shell {
        background: var(--qf-bg);
        padding: clamp(20px,3vw,36px);
    }

    .qf-card {
        max-width: 900px;
        margin: 0 auto;
        background: var(--qf-card);
        border: 1px solid var(--qf-border);
        border-radius: 16px;
        box-shadow: var(--qf-shadow);
        padding: clamp(18px,2vw,28px);
    }

    /* Header */
    .qf-header {
        background: linear-gradient(135deg, rgba(20,83,45,.08) 0%, rgba(27,141,164,.06) 100%);
        border: 1px solid var(--qf-border);
        border-radius: 12px;
        padding: 16px 18px;
        margin-bottom: 16px;
        position: relative;
        overflow: hidden;
    }

        .qf-header:before {
            content: "";
            position: absolute;
            inset: -1px;
            background: radial-gradient(420px 150px at -10% -20%, rgba(20,83,45,.18) 0%, transparent 60%), radial-gradient(300px 120px at 110% -10%, rgba(27,141,164,.16) 0%, transparent 55%);
            pointer-events: none;
            opacity: .7;
        }

    .qf-title {
        margin: 0;
        font-weight: 800;
        color: var(--qf-text);
        font-size: 1.6rem;
        letter-spacing: .2px;
    }

    .qf-subtitle {
        margin: .25rem 0 0;
        color: var(--qf-muted);
    }

    /* Grid del formulario */
    .form-grid {
        display: grid;
        gap: 16px;
        grid-template-columns: repeat(2, minmax(0,1fr));
    }

    @@media (max-width: 768px) {
        .form-grid {
            grid-template-columns: 1fr;
        }
    }

    /* Inputs con icono */
    .form-group label {
        font-weight: 700;
        color: var(--qf-text);
        margin-bottom: 6px;
        display: block;
    }

    .input-icon {
        position: relative;
    }

        .input-icon i {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #5f6f72;
            font-size: 1.05rem;
        }

    .form-control {
        width: 100%;
        border: 1px solid var(--qf-border);
        border-radius: 10px;
        padding: 12px 12px 12px 40px;
        font-size: 1rem;
        color: var(--qf-text);
        background: #fff;
        outline: none;
        transition: border-color .15s ease, box-shadow .15s ease, background .15s ease;
    }

        .input-icon.focus .form-control,
        .form-control:focus {
            border-color: #b6d2c4;
            box-shadow: 0 0 0 3px rgba(20,83,45,.10);
            background: #fff;
        }

        .form-control[readonly] {
            background: #f7faf9;
            cursor: not-allowed;
        }

    /* Validación */
    .field-error {
        color: #b63745;
        font-size: .88rem;
    }

    /* Botones (mismos textos) */
    .form-buttons {
        margin-top: 6px;
        display: flex;
        flex-wrap: wrap;
        gap: .6rem;
    }

    .btn-submit {
        background: var(--qf-primary);
        color: #fff;
        border: none;
        border-radius: 10px;
        padding: .6rem .95rem;
        font-weight: 800;
        display: inline-flex;
        align-items: center;
        gap: .4rem;
        box-shadow: 0 2px 8px rgba(20,83,45,.18);
        text-decoration: none;
        cursor: pointer;
        transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
    }

        .btn-submit:hover {
            transform: translateY(-1px);
            background: #104026;
        }

    .btn-cancel {
        background: #eff5f2;
        color: #14532D;
        border: 1px solid #d7e7de;
        border-radius: 10px;
        padding: .6rem .9rem;
        font-weight: 800;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: .4rem;
    }

        .btn-cancel:hover {
            background: #e5efe9;
        }

    /* Notificación */
    .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #4CAF50;
        color: #fff;
        padding: 14px 22px;
        border-radius: 10px;
        font-weight: 700;
        box-shadow: 0 6px 18px rgba(0,0,0,.12);
        z-index: 1000;
        animation: fadeInOut 3s ease;
    }

    @@keyframes fadeInOut {
        0% {
            opacity: 0
        }

        10% {
            opacity: 1
        }

        90% {
            opacity: 1
        }

        100% {
            opacity: 0
        }
    }
</style>
